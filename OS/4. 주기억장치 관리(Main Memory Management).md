# 4. 주기억장치 관리<br>(Main Memory Management)

## 4.1 메모리 역사

+ 메모리의 종류
  + Core memory
    + 원형 코일(?)에 자석물질을 발라 전기를 가하면 자장이 발생한다. (플레밍의 오른손법칙)에 따라 전기의 방향을 다르게 하여 자장을 기록한다.
  + 진공관 메모리
    + 50~60년대 사용.
    + core 메모리와 진공관 메모리 때에는 메모리가 아주 비싼 자원이었다.
  + 트렌지스터 메모리 
    + 70~80년대
  + 집적회로 메모리
    + SRAM :캐시 저장
    + DRAM : 메인 메모리
+ 메모리의 용량
  + 1970년대 : 8bit PC, 64KB
  + 1980년대 : 16bit IBM-PC, 640KB -> 1MB -> 4MB
  + 1990년대 : 수 MB -> 수십 MB
  + 2000년 ~ 현재 : 수백 MB -> 수 GB
+ 그러나 언제나 부족한 메모리(메모리의 양이 많이 늘었지만 여전히 부족하다)
  + 프로그램 사이즈가 커졌다.
    + 기계어 / 어셈블리어 :arrow_right: C언어 :arrow_right: 자바, 객체지향형 언어
  + 처리 데이터가 커졌다.
    + 숫자 처리 :arrow_right: 문자 처리 :arrow_right: 멀티미디어 처리 :arrow_right: Big Data
+ 메모리 용량 증가 vs 프로그램 크기 증가
  + 메모리 용량이 증가하는 속도에 맞추어(어쩌면 더 빠르게) 프로그램 크기가 증가한다.
+ *어떻게 메모리를 효과적으로 사용할 수 있을까?*
  + **메모리 낭비 없애기**
  + **가상 메모리(virtual memory)**





## 4.2 메모리 주소

### 프로그램 개발과 개발도구

+ CPU와 Memory 사이에는 주소(address)와 데이터(Data)를 주고 받는다.

  + 주소 : CPU에서 위치 접근
  + 데이터 : 쌍방향. 읽고 쓰기

  <img src="img/4-2.jpg" alt="4-2" style="zoom:50%;" />

+ 프로그램 개발

  + 원천 파일 (Source file) : 고수준 언어 또는 어셈블리 언어
  + 목적 파일 (Object file) : 컴파일 또는 어셈블 결과
  + 실행 파일 (Executable file) : 링크 결과

+ 개발 도구

  + 컴파일러 (Compiler) 
    + C언어 등의 고수준 언어를 목적파일로 변환해주는 도구
    + 목적파일은 1010000 모양의 기계어 등으로 표현된다.
  + 어셈블러 (assembler)
    + 어셈블리 언어를 목적파일로 변환해 주는 도구
  + 링커 (Linker)
    + 컴파일러나 어셈블러를 거쳐온 목적파일, 라이브러리로 부터 만들어진 파일들을 하나로 묶어 exe 파일을 만드는 도구
  + 로더 (loader)
    + 실행 파일을 메인 메모리에 올리는 도구

  <img src="img/4-2-develop-exe.jpg" alt="4-2-develop-exe" style="zoom:50%;" />



### 실행파일을 메모리에 올리기

+ 실행파일을 메모리에 올리려면?

  + 메모리 몇번지에 올릴것인가?
    + 프로그램이 하나씩만도는 싱글 프로그래밍 환경에서는 하나의 프로세스를 실행한 후, 종료하면 다른 프로그램을 실행시키면 된다.
  + 다중프로그래밍 환경에서는 어떻게?
    + 여러개의 프로세스가 메모리에 올라갈것이다. 
    + 하지만 CPU는 주소가 0번(O/S마다 다르다)이어야만 프로세스를 실행시킬 수 있다.
    + MMU를 사용하자!

+ MMU 사용

  + MMU에는 재배치 레지스터(relocation register)라는 레지스터가 존재한다.
  + CPU는 프로세스가 0번에 있다고 생각하지만 실제로는 메모리 주소 1000번에 존재한다. 이렇게 CPU를 착각하게 만든다.

+ 주소 구분

  + 논리 주소 (logical address) : CPU에서 memory로 향하는 주소. MMU 거치기 전
  + 물리 주소 (physical address) : MMU를 거쳐 나온 실제 메모리에 저장된 주소.

  <img src="img/4-2-MMU.jpg" alt="4-2-MMU" style="zoom:33%;" />

